(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{132:function(t,s,a){"use strict";a.r(s);var e={name:"MailsClasses",data:function(){return{compose:{subject:null,message:null},mails:{}}},created:function(){this.fetchData(),this.$parent.fetchData()},watch:{$route:"fetchData"},methods:{delete_post:function(t){var s=this;axios.post("/academic/classes/"+t.id+"/mails/delete").then((function(t){s.$root.post_success(t.data.success),s.mails=t.data.mails,s.mails.profile_id=t.data.profile_id,s.compose={}}))},submitMail:function(t){var s=this;t.preventDefault(),axios.post("/academic/classes/"+this.$route.params.id+"/mails/post",this.compose).then((function(t){s.$root.post_success(t.data.success),s.mails=t.data.mails,s.mails.profile_id=t.data.profile_id,s.compose={}}))},fetchData:function(){this.get_mails()},get_mails:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;axios.get("/academic/classes/"+this.$route.params.id+"/mails?page="+s).then((function(s){t.mails=s.data.mails,t.mails.profile_id=s.data.profile_id}))}}},i=a(0),n=Object(i.a)(e,(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-xl-12 order-xl-1"},[a("div",{staticClass:"card bg-secondary shadow"},[a("div",{staticClass:"card-header bg-white border-0"},[a("h3",[a("i",{staticClass:"ni ni-email-83"}),t._v(" "),t.$parent.term_class.course?a("router-link",{attrs:{to:{name:"ac.classes.show",params:{id:t.$parent.term_class.id}}}},[t._v("\n                        "+t._s(t.$parent.term_class.course.name)+"\n                    ")]):t._e(),t._v("\n                    Mail Posts\n                    "),a("div",{staticClass:"float-right"},[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(s){return t.$parent.$router.back()}}},[a("i",{staticClass:"ni ni-bold-left"}),t._v(" Back\n                        ")])])],1)]),t._v(" "),a("div",{staticClass:"card-body"},[a("form",{on:{submit:t.submitMail}},[a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.compose.subject,expression:"compose.subject"}],staticClass:"form-control",attrs:{required:"",type:"text",maxlength:"200",placeholder:"Subject"},domProps:{value:t.compose.subject},on:{input:function(s){s.target.composing||t.$set(t.compose,"subject",s.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.compose.message,expression:"compose.message"}],staticClass:"form-control",attrs:{required:"",maxlength:"4000",rows:"3",placeholder:"Compose"},domProps:{value:t.compose.message},on:{input:function(s){s.target.composing||t.$set(t.compose,"message",s.target.value)}}})]),t._v(" "),t._m(0)])]),t._v(" "),a("div",{staticClass:"card-footer"},[t._l(t.mails.data,(function(s){return a("div",{staticClass:"alert",class:[s.profile_id!==t.mails.profile_id?"alert-default":"alert-primary"],attrs:{role:"alert"}},[a("span",{staticClass:"alert-inner--text"},[a("h4",[s.profile_id!==t.mails.profile_id?a("span",{staticClass:"text-white float-right",attrs:{title:s.profile.user.num}},[t._m(1,!0),t._v("\n                                "+t._s(t.$root.full_name(s.profile.user))+"\n                                -\n                                "),a("small",[t._v("\n                                    "+t._s(s.profile.user.email)+"\n                                ")])]):t.$root.minutes_lapsed(s.created_at)<=1?a("div",[a("button",{staticClass:"btn btn-sm btn-danger float-right",on:{click:function(a){return t.delete_post(s)}}},[t._v("\n                                    Delete\n                                ")])]):t._e()]),t._v(" "),a("p",[a("strong",{staticClass:"text-underline"},[t._v(t._s(s.subject))]),a("br"),t._v("\n                            "+t._s(s.message)+"\n                        ")])]),t._v(" "),a("small",{staticClass:"float-right"},[a("i",{staticClass:"ni ni-time-alarm"}),t._v(" "+t._s(t.$root.moment(s.created_at))+"\n                    ")])])})),t._v(" "),a("laravel-vue-pagination",{attrs:{limit:5,data:t.mails,align:"center"},on:{"pagination-change-page":t.get_mails}})],2)])])])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"form-group"},[s("button",{staticClass:"btn btn-icon btn-primary float-right",attrs:{type:"submit"}},[s("span",{staticClass:"btn-inner--icon"},[s("i",{staticClass:"ni ni-send"})]),this._v(" "),s("span",{staticClass:"btn-inner--text"},[this._v("Post")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("span",{staticClass:"alert-inner--icon"},[s("i",{staticClass:"ni ni-single-02"})])}],!1,null,"78799946",null);s.default=n.exports}}]);