(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{113:function(t,s,e){"use strict";e.r(s);var a=e(5),r={components:{FakeFormInputs:a.default},name:"EditClasses",data:function(){return{window:window,courses:[],major_term_classes:[],venues:[],errors:null,search:{course:"",venue:""},week_days:window.week_days,times:this.$parent.form.input.times}},created:function(){this.venues.push(this.$parent.form.input.term_class.venue)},methods:{removeDayInput:function(t){this.$parent.form.input.term_class.times.splice(t,1)},addDayInput:function(){this.$parent.form.input.term_class.times.push({day:"",time:""})},submitForm:function(t){var s=this;t.preventDefault(),axios.post("/admin/classes/edit",this.$parent.form.input.term_class).then((function(t){s.$root.post_success(t.data.success),s.$router.push({name:"ad.show.classes",params:{class:s.$parent.form.input.term_class.id}})}))},searchVenue:function(){var t=this;axios.post("/admin/search/venues",{search:this.search.venue}).then((function(s){t.venues=s.data.venues}))}}},n=e(0),i={components:{EditClasses:Object(n.a)(r,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"card shadow mb-4 mb-xl-0 col-md-10"},[e("div",{staticClass:"card-header bg-transparent"},[e("div",{staticClass:"float-right"},[e("router-link",{staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"ad.show.classes",params:{term:t.$parent.form.input.term_class.id}}}},[e("i",{staticClass:"ni ni-bold-left"}),t._v(" Back\n                ")])],1),t._v(" "),e("h3",{staticClass:"mb-0"},[t._v("\n                Edit Class\n            ")]),t._v(" "),t._m(0)]),t._v(" "),e("div",{staticClass:"card-body"},[e("form",{on:{submit:t.submitForm}},[e("fake-form-input"),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"form-group col-md-4"},[e("small",[t._v("Search venue by room number")]),t._v(" "),e("div",{staticClass:"input-group mb-4"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.search.venue,expression:"search.venue"}],staticClass:"form-control",attrs:{placeholder:"...",type:"text"},domProps:{value:t.search.venue},on:{input:[function(s){s.target.composing||t.$set(t.search,"venue",s.target.value)},t.searchVenue]}})])]),t._v(" "),e("div",{staticClass:"form-group mb-3 col-md-8"},[e("small",[t._v("Venues found")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.venues.length>0,expression:"venues.length > 0"}],staticClass:"input-group"},[t._m(2),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.$parent.form.input.term_class.venue_id,expression:"$parent.form.input.term_class.venue_id"}],staticClass:"form-control",attrs:{required:""},on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.$parent.form.input.term_class,"venue_id",s.target.multiple?e:e[0])}}},t._l(t.venues,(function(s){return e("option",{domProps:{value:s.id}},[t._v("\n                                    "+t._s(s.name)+"\n                                ")])})),0)])])]),t._v(" "),e("hr"),t._v(" "),t._l(Object.keys(t.$parent.form.input.term_class.times),(function(s){return e("div",{staticClass:"row"},[e("div",{staticClass:"form-group mb-3 col-md-6"},[e("div",{staticClass:"input-group"},[t._m(3,!0),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.$parent.form.input.term_class.times[s].day,expression:"$parent.form.input.term_class.times[day].day"}],staticClass:"form-control",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.$parent.form.input.term_class.times[s],"day",e.target.multiple?a:a[0])}}},t._l(t.week_days,(function(s){return e("option",{domProps:{value:s}},[t._v("\n                                    "+t._s(s)+"\n                                ")])})),0)])]),t._v(" "),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.$parent.form.input.term_class.times[s].time,expression:"$parent.form.input.term_class.times[day].time"}],staticClass:"form-control",attrs:{type:"time",placeholder:"Time",required:""},domProps:{value:t.$parent.form.input.term_class.times[s].time},on:{input:function(e){e.target.composing||t.$set(t.$parent.form.input.term_class.times[s],"time",e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"col-md-2"},[e("button",{staticClass:"btn btn-outline-danger btn-block",on:{click:function(e){return t.removeDayInput(s)}}},[e("i",{staticClass:"ni ni-fat-remove"})])])])})),t._v(" "),e("button",{staticClass:"btn btn-default",on:{click:t.addDayInput}},[e("i",{staticClass:"ni ni-fat-add"}),t._v(" Add\n                ")]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6 form-group mb-3"},[e("div",{staticClass:"input-group"},[t._m(4),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.$parent.form.input.term_class.size,expression:"$parent.form.input.term_class.size"}],staticClass:"form-control",attrs:{type:"number",min:t.window.options.min_class_size,max:t.window.options.max_class_size,required:""},domProps:{value:t.$parent.form.input.term_class.size},on:{input:function(s){s.target.composing||t.$set(t.$parent.form.input.term_class,"size",s.target.value)}}})])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Save changes")]),t._v(" "),e("button",{staticClass:"btn btn-link ml-auto",attrs:{type:"button"},on:{click:function(s){return t.$router.go(-1)}}},[t._v("\n                        Back\n                    ")])])],2)])])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("small",[this._v("\n                Can edit the following;\n                "),s("ul",[s("li",[this._v("Venue")]),this._v(" "),s("li",[this._v("Days")]),this._v(" "),s("li",[this._v("Class Size")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[s("i",{staticClass:"ni ni-zoom-split-in"})])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[this._v("\n                                            Venue:\n                                        ")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[this._v("\n                                            Day:\n                                        ")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[this._v("Class Size:")])])}],!1,null,"f3d615f6",null).exports,FakeFormInputs:a.default},name:"ViewClasses",data:function(){return{term_class:{},reset:{assessment:null,form:{}},form:{input:{profile_id:null,remove_id:null,password:null,search:"",term_class:null},delete:{id:null,password:null}},lecturers:[],errors:null,class_registrations:{}}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{registerAllStudents:function(){var t=this;axios.post("/admin/classes/register-all-students",{class:this.$route.params.class}).then((function(s){t.$root.post_success(s.data.success),t.term_class=s.data.term_class}))},resetAssessmentForm:function(t){var s=this;t.preventDefault(),axios.post("/admin/classes/reset/assessment",this.reset.form).then((function(t){s.$root.post_success(t.data.success),s.term_class=t.data.term_class}))},reset_assessment:function(t){this.reset.assessment=t,this.reset.form.id=t.id,this.reset.form.score=t.score,this.reset.form.term_class_id=this.term_class.id,this.reset.form.password=null,this.$modal.show("reset_assessment")},view_students:function(){this.get_students(),this.$modal.show("students")},get_students:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;axios.get("/admin/classes/registrations="+this.term_class.id+"?page="+s).then((function(s){t.class_registrations=s.data.class_registrations}))},search:function(){var t=this;this.lecturers={},axios.post("/admin/search/lecturers",{search:this.form.input.search}).then((function(s){t.lecturers=s.data.lecturers}))},submitDeleteForm:function(t){var s=this;t.preventDefault(),this.form.delete.id=this.term_class.id,this.form.delete.term=this.term_class.term,axios.post("/admin/classes/destroy",this.form.delete).then((function(t){s.$root.post_success(t.data.success),s.$router.push({name:"ad.term.classes",params:{term:s.form.delete.term.id}})}))},submitForm:function(t){var s=this;t.preventDefault(),this.form.input.term_class_id=this.term_class.id,"al"===this.form.type&&axios.post("/admin/classes/add-lecturer",this.form.input).then((function(t){s.term_class=t.data.term_class,s.$root.post_success(t.data.success),s.get_class(s.$route.params.class),s.$modal.hide("add_lecturer")}))},addLecturer:function(){this.$modal.show("add_lecturer"),this.form.input={password:"",profile_id:null,remove_id:0},this.form.type="al"},fetchData:function(){this.get_class(this.$route.params.class),void 0===this.$route.params.ops&&(this.form.input.term_class=null)},get_class:function(t){var s=this;axios.get("/admin/classes/show="+t).then((function(t){s.term_class=t.data.term_class,"edit"===s.$route.params.ops&&(s.form.input.term_class=s.term_class)}))}}},l=Object(n.a)(i,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"col-md-12"},[t.form.input.term_class?e("EditClasses"):e("div",{staticClass:"card shadow mb-4 mb-xl-0",attrs:{id:"view"}},[e("div",{staticClass:"card-header bg-transparent"},[e("h2",{staticClass:"mb-0"},[e("i",{staticClass:"ni ni-calendar-grid-58"}),t._v(" "),t.term_class.term?e("router-link",{attrs:{to:{name:"ad.term.classes",params:{term:t.term_class.term.id}}}},[t._v("\n                        "+t._s(t.term_class.term.name)+"\n                    ")]):t._e(),t._v("\n                    Class\n                    "),e("div",{staticClass:"float-right"},[e("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(s){return t.$modal.show("delete_modal")}}},[t._v("Delete")]),t._v(" "),e("router-link",{staticClass:"btn btn-warning btn-sm",attrs:{to:{name:"ad.show.classes",params:{term:t.term_class.id,ops:"edit"}}}},[t._v("\n                            Edit\n                        ")])],1)],1)]),t._v(" "),e("modal",{attrs:{scrollable:!0,name:"delete_modal",height:"auto"}},[e("h2",{staticClass:"modal-header"},[t._v("Delete Class")]),t._v(" "),e("div",{staticClass:"modal-body"},[e("form",{on:{submit:t.submitDeleteForm}},[e("fake-form-input"),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Save changes")])])],1)])]),t._v(" "),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table align-items-center table-flush"},[e("tbody",[e("tr",[e("td",[t._v("Course")]),t._v(" "),t.term_class.course?e("th",[t.term_class.term_class?e("span",{staticClass:"text-underline"},[t._v(t._s(t.term_class.term_class.course.name)+" "),e("br")]):t._e(),t._v("\n                            "+t._s(t.term_class.course.name)+"\n                        ")]):t._e()]),t._v(" "),e("tr",[e("td",[t._v("Venue")]),t._v(" "),0!==t.term_class.venue_id?e("th",[t._v(t._s(t.term_class.venue.name))]):t._e()]),t._v(" "),e("tr",[e("td",[t._v("Times")]),t._v(" "),t.term_class.times?e("th",t._l(t.term_class.times,(function(s){return e("li",[e("strong",[t._v(t._s(s.day))]),t._v(", "+t._s(t.$root.moment(s.time))+"\n                            ")])})),0):t._e()]),t._v(" "),e("tr",[e("td",[t._v("Size")]),t._v(" "),e("th",[t._v("\n                            "+t._s(t.term_class.taken)+" "),e("small",[t._v("taken")]),t._v("\n                            +\n                            "+t._s(t.term_class.size-t.term_class.taken)+" "),e("small",[t._v("available")]),t._v("\n                            /\n                            "),e("small",[t._v("total")]),t._v(" "+t._s(t.term_class.size)+"\n                            "),e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar bg-danger",style:"width: "+t.term_class.taken/t.term_class.size*100+"%;",attrs:{role:"progressbar","aria-valuenow":t.term_class.taken,"aria-valuemin":"0","aria-valuemax":t.term_class.size}})])])]),t._v(" "),e("tr",[e("td",[t._v("Students")]),t._v(" "),e("th",[e("button",{staticClass:"btn btn-primary btn-sm",on:{click:t.view_students}},[t._v("\n                                "+t._s(t.term_class.taken)+" registered students.\n                            ")])])]),t._v(" "),e("modal",{attrs:{name:"students",height:"auto",draggable:!0}},[e("div",{staticClass:"modal modal-content"},[e("div",{staticClass:"modal-header"},[t._v("\n                                Registered Students\n                            ")]),t._v(" "),e("button",{staticClass:"btn btn-danger btn-sm float-right",on:{click:t.registerAllStudents}},[t._v("Register All Students from Set")]),t._v(" "),e("div",{staticClass:"modal-body"},[e("table",{staticClass:"table"},[e("thead",[e("tr",[e("th",[t._v("#")]),t._v(" "),e("th",[t._v("Student")]),t._v(" "),e("th")])]),t._v(" "),e("tbody",t._l(t.class_registrations.data,(function(s){return e("tr",[e("td",[t._v(t._s(s.profile.user.num))]),t._v(" "),e("td",[t._v(t._s(t.$root.full_name(s.profile.user)))]),t._v(" "),e("td",[e("router-link",{staticClass:"btn btn-sm btn-primary",attrs:{to:{name:"ad.student.classes",params:{class:t.term_class.id,id:s.profile.id}},target:"_blank"}},[e("i",{staticClass:"ni ni-bullet-list-67"})])],1)])})),0)]),t._v(" "),e("laravel-vue-pagination",{attrs:{limit:5,data:t.class_registrations,align:"center"},on:{"pagination-change-page":t.get_students}})],1)])]),t._v(" "),e("tr",[e("td",[t._v("Lecturers")]),t._v(" "),t.term_class.class_lecturers?e("th",[t._l(t.term_class.class_lecturers,(function(s){return e("li",[t._v("\n                                "+t._s(t.$root.full_name(s.profile.user))+"\n                                "),e("small",{staticClass:"text-underline"},[t._v(t._s(s.profile.user.email))])])})),t._v(" "),e("br"),t._v(" "),e("button",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.auth.hasRole("ad-6"),expression:"$store.state.auth.hasRole('ad-6')"}],staticClass:"btn btn-sm btn-outline-dark",on:{click:t.addLecturer}},[e("i",{staticClass:"ni ni-ruler-pencil"}),t._v(" Lecturer Allocation\n                            ")]),t._v(" "),e("modal",{attrs:{scrollable:!0,name:"add_lecturer",height:"auto"}},[e("div",{staticClass:"modal modal-content"},[e("h1",{staticClass:"modal-header"},[t._v("Lecturer Allocation")]),t._v(" "),e("form",{staticClass:"modal-body",on:{submit:t.submitForm}},[e("fake-form-input"),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("label",[t._v("Add Lecturer")])]),t._v(" "),e("div",{staticClass:"form-group  col-md-4"},[e("div",{staticClass:"input-group mb-4"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("i",{staticClass:"ni ni-zoom-split-in"})])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.input.search,expression:"form.input.search"}],staticClass:"form-control",attrs:{placeholder:"Search lecturer by name or email..",type:"text"},domProps:{value:t.form.input.search},on:{change:t.search,input:function(s){s.target.composing||t.$set(t.form.input,"search",s.target.value)}}})])]),t._v(" "),e("div",{staticClass:"form-group mb-3 col-md-8"},[e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[t._v("\n                                                        User:\n                                                    ")])]),t._v(" "),t.lecturers.length?e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.input.profile_id,expression:"form.input.profile_id"}],staticClass:"form-control",attrs:{required:""},on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form.input,"profile_id",s.target.multiple?e:e[0])}}},t._l(t.lecturers,(function(s){return e("option",{domProps:{value:s.profile.id}},[t._v("\n                                                            "+t._s(t.$root.full_name(s.user)+" - "+s.user.email)+"\n                                                        ")])})),0):t._e()])]),t._v(" "),e("div",{staticClass:"form-group mb-3 col-12"},[e("label",[t._v("Remove Lecturer")]),t._v(" "),e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("i",{staticClass:"ni ni-fat-remove"})])]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.input.remove_id,expression:"form.input.remove_id"}],staticClass:"form-control",on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form.input,"remove_id",s.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"0"}},[t._v("*** None")]),t._v(" "),t._l(t.term_class.class_lecturers,(function(s){return e("option",{domProps:{value:s.id}},[t._v("\n                                                            "+t._s(t.$root.full_name(s.profile.user))+" -\n                                                            "+t._s(s.profile.user.email)+"\n                                                        ")])}))],2)])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Save changes")])])])],1)])])],2):t._e()]),t._v(" "),t.term_class.assessments?e("tr",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.auth.hasRole("ad-5.1"),expression:"$store.state.auth.hasRole('ad-5.1')"}]},[e("td",[t._v("Assessments")]),t._v(" "),e("th",t._l(t.term_class.assessments,(function(s){return e("li",[t._v("\n                                "+t._s(s.name)+"\n                                "),e("small",{staticClass:"text-underline"},[t._v(t._s(s.score)+" / 100")]),t._v(" "),e("button",{staticClass:"btn btn-link text-warning",on:{click:function(e){return t.reset_assessment(s)}}},[e("i",{staticClass:"ni ni-settings-gear-65"})]),t._v(" "),e("modal",{attrs:{name:"reset_assessment",height:"auto",draggable:!0}},[e("div",{staticClass:"modal modal-content"},[e("div",{staticClass:"modal-header"},[t._v("\n                                            Reset Assessment\n                                        ")]),t._v(" "),e("div",{staticClass:"modal-body"},[e("p",[t._v("\n                                                When save changes clicked, all grades uploaded under this assessment\n                                                "),e("br"),t._v("\n                                                will be reset. Assessment score can be changed from this form.\n                                            ")]),t._v(" "),t.reset.assessment?e("table",{staticClass:"table align-items-center table-flush"},[e("tbody",[e("tr",[e("td",[t._v("Assessment")]),t._v(" "),e("th",[t._v(t._s(t.reset.assessment.name))])]),t._v(" "),e("tr",[e("td",[t._v("Current Score")]),t._v(" "),e("th",[t._v(t._s(t.reset.assessment.score)+" / 100")])])])]):t._e(),t._v(" "),e("hr"),t._v(" "),e("form",{on:{submit:t.resetAssessmentForm}},[e("fake-form-input"),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Save changes")])])],1)])])])],1)})),0)]):t._e()],1)])])],1)],1)}),[],!1,null,"fca99b64",null);s.default=l.exports}}]);