(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{103:function(t,e,a){"use strict";a.r(e);var s={name:"IndexGroups"},r=a(0),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"card shadow mb-4 mb-xl-0"},[a("div",{staticClass:"card-header bg-transparent"},[a("h3",{staticClass:"mb-0"},[a("div",{staticClass:"float-right"},[a("router-link",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.auth.hasRole("ad-7"),expression:"$store.state.auth.hasRole('ad-7')"}],staticClass:"btn btn-sm btn-outline-primary mb-3",attrs:{to:{name:"ad.groups",params:{ops:"create"}},"data-toggle":"modal","data-target":"#modal-term"}},[t._v("\n                        Add New group\n                    ")])],1)])]),t._v(" "),a("form",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"input-group mb-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.$parent.filter.search,expression:"$parent.filter.search"}],staticClass:"form-control",attrs:{placeholder:"Search by course code or name...",type:"text"},domProps:{value:t.$parent.filter.search},on:{input:function(e){e.target.composing||t.$set(t.$parent.filter,"search",e.target.value)}}}),t._v(" "),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.$parent.get_groups(1)}}},[a("i",{staticClass:"ni ni-zoom-split-in"}),t._v("\n                            Search\n                        ")])])])])]),t._v(" "),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table align-items-center table-flush"},[t._m(0),t._v(" "),a("tbody",[t._l(t.$parent.groups.data,(function(e){return a("tr",[a("td",[a("router-link",{staticClass:"btn btn-primary btn-sm",attrs:{to:{name:"ad.groups",params:{id:e.id}}}},[a("i",{staticClass:"ni ni-bold-right"})])],1),t._v(" "),a("th",{attrs:{scope:"row"}},[t._v(t._s(e.name))]),t._v(" "),a("th",{attrs:{scope:"row"}},[t._v(t._s(e.department.name))])])})),t._v(" "),t._m(1)],2)]),t._v(" "),a("laravel-vue-pagination",{attrs:{limit:5,data:t.$parent.groups,align:"center"},on:{"pagination-change-page":t.$parent.get_groups}})],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{scope:"col"}}),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Name")]),this._v(" "),e("th",{attrs:{scope:"col"}},[this._v("Department")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",{attrs:{scope:"row"}}),this._v(" "),e("td"),this._v(" "),e("td")])}],!1,null,"79f1a862",null).exports,o=a(57);function i(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var s=0,r=function(){};return{s:r,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,i=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){i=!0,n=t},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw n}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}var u={name:"ViewGroups",components:{VueTagsInput:a.n(o).a},data:function(){return{tag:"",availableTags:{},tags:[],password:"",autocompleteItems:[]}},watch:{tags:"loadAvailableRoles"},mounted:function(){this.loadRoles()},computed:{filteredItems:function(){var t=this;return this.autocompleteItems.filter((function(e){return-1!==e.text.toLowerCase().indexOf(t.tag.toLowerCase())}))}},methods:{loadAvailableRoles:function(){for(var t in this.availableTags={},window.roles)this.availableTags[t]={text:window.roles[t],display:!0};var e,a=i(this.tags);try{for(a.s();!(e=a.n()).done;){var s=e.value;this.availableTags[s.i].display=!1}}catch(t){a.e(t)}finally{a.f()}},loadRoles:function(){this.tags=[];var t,e=i(this.$parent.group.roles);try{for(e.s();!(t=e.n()).done;){var a=t.value;this.tags.push({text:window.roles[a],i:a})}}catch(t){e.e(t)}finally{e.f()}for(var s in window.roles)this.autocompleteItems.push({text:window.roles[s],i:s})},submitForm:function(t){var e=this;t.preventDefault();var a,s={roles:[],password:this.password,group:this.$parent.group.id},r=i(this.tags);try{for(r.s();!(a=r.n()).done;){var n=a.value;s.roles.push(n.i)}}catch(t){r.e(t)}finally{r.f()}axios.post("/admin/groups/store-roles",s).then((function(t){e.$root.post_success(t.data.success),e.password=null}))}}},p=Object(r.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"card shadow mb-4 mb-xl-0",attrs:{id:"view"}},[a("div",{staticClass:"card-header bg-transparent"},[a("h3",{staticClass:"mb-0"},[a("div",{staticClass:"float-left"},[a("router-link",{staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"ad.groups"}}},[a("i",{staticClass:"ni ni-bold-left"}),t._v(" Back\n                        ")])],1),t._v(" "),a("div",{staticClass:"float-right"},[a("router-link",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.auth.hasRole("ad-7"),expression:"$store.state.auth.hasRole('ad-7')"}],staticClass:"btn btn-outline-warning btn-sm",attrs:{to:{name:"ad.groups",params:{id:t.$parent.group.id,ops:"edit"}}}},[t._v("\n                            Edit\n                        ")]),t._v(" "),a("router-link",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.auth.hasRole("ad-7"),expression:"$store.state.auth.hasRole('ad-7')"}],staticClass:"btn btn-outline-danger btn-sm",attrs:{to:{name:"ad.groups",params:{id:t.$parent.group.id,ops:"delete"}}}},[t._v("\n                            Delete\n                        ")])],1)])]),t._v(" "),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table align-items-center table-flush"},[a("tbody",[a("tr",[a("td",[t._v("Name")]),t._v(" "),a("th",[t._v(t._s(t.$parent.group.name))])]),t._v(" "),a("tr",[a("td",[t._v("Description")]),t._v(" "),a("th",[t._v(t._s(t.$parent.group.description))])]),t._v(" "),a("tr",[a("td",[t._v("Department")]),t._v(" "),a("th",[t._v(t._s(t.$parent.group.department.name))])])])])]),t._v(" "),a("div",{staticClass:"card-body"},[a("form",{on:{submit:t.submitForm}},[a("fake-form-input"),t._v(" "),a("div",{staticClass:"form-group mb-3"},t._l(t.availableTags,(function(e){return a("span",{directives:[{name:"show",rawName:"v-show",value:e.display,expression:"role.display"}],staticClass:"badge badge-dark"},[t._v("\n                            "+t._s(e.text)+"\n                        ")])})),0),t._v(" "),a("div",{staticClass:"form-group mb-3"},[a("vue-tags-input",{attrs:{placeholder:"Assign role","add-only-from-autocomplete":!0,tags:t.tags,"autocomplete-items":t.filteredItems},on:{"tags-changed":function(e){return t.tags=e}},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}})],1)],1)])])])}),[],!1,null,"039743d6",null).exports,c={name:"FormGroups"},d={name:"Groups",components:{FormGroups:Object(r.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"card shadow mb-4 mb-xl-0",attrs:{id:"view"}},[a("div",{staticClass:"card-header bg-transparent"},[a("router-link",{staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"ad.groups"}}},[a("i",{staticClass:"ni ni-bold-left"}),t._v(" Back\n                ")]),t._v(" "),a("span",{domProps:{textContent:t._s(t.$parent.form.title)}})],1),t._v(" "),a("div",{staticClass:"card-body"},[a("form",{on:{submit:t.$parent.submitForm}},[a("fake-form-input"),t._v(" "),void 0!==t.$parent.form.input.name?a("div",{staticClass:"form-group mb-3"},[a("div",{staticClass:"input-group"},[t._m(0),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.$parent.form.input.name,expression:"$parent.form.input.name"}],staticClass:"form-control",attrs:{placeholder:"group Name",type:"text",name:"name",required:""},domProps:{value:t.$parent.form.input.name},on:{input:function(e){e.target.composing||t.$set(t.$parent.form.input,"name",e.target.value)}}})])]):t._e(),t._v(" "),void 0!==t.$parent.form.input.description?a("div",{staticClass:"form-group mb-3"},[a("label"),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.$parent.form.input.description,expression:"$parent.form.input.description"}],staticClass:"form-control form-control-alternative",attrs:{required:"",rows:"4",placeholder:"group description ..."},domProps:{value:t.$parent.form.input.description},on:{input:function(e){e.target.composing||t.$set(t.$parent.form.input,"description",e.target.value)}}})]):t._e(),t._v(" "),void 0!==t.$parent.form.input.department_id?a("div",{staticClass:"form-group mb-3"},[a("div",{staticClass:"input-group"},[t._m(1),t._v(" "),a("v-select",{staticClass:"form-control",attrs:{options:t.$parent.departments,reduce:function(t){return t.id},label:"name"},scopedSlots:t._u([{key:"search",fn:function(e){var s=e.attributes,r=e.events;return[a("input",t._g(t._b({staticClass:"vs__search",attrs:{required:!t.$parent.form.input.department_id}},"input",s,!1),r))]}}],null,!1,1535220183),model:{value:t.$parent.form.input.department_id,callback:function(e){t.$set(t.$parent.form.input,"department_id",e)},expression:"$parent.form.input.department_id"}})],1)]):t._e(),t._v(" "),t._m(2)],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("i",{staticClass:"ni ni-align-left-2"})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[e("i",{staticClass:"ni ni-building"})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("Save changes")])])}],!1,null,"6276bb68",null).exports,ViewGroups:p,IndexGroups:n},data:function(){return{filter:{search:null,search_q:""},roles:{},window_roles:window.roles,roles_success:null,roles_error:null,groups:null,group:null,form:null,departments:[]}},mounted:function(){this.$store.state.page="groups"},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{get_non_major_departments:function(){var t=this;axios.get("/admin/get/departments?is_major=0").then((function(e){t.departments=e.data.departments}))},fetchData:function(){var t=this;"create"===this.$route.params.id||"create"===this.$route.params.ops?(this.get_non_major_departments(),this.groups=null,this.form={title:"Create",type:"c",input:{name:"",description:"",department_id:""}}):this.$route.params.id?(this.groups=null,axios.get("/admin/groups/"+this.$route.params.id).then((function(e){t.group=e.data.group,t.loadRoles(),t.form=null,"edit"===t.$route.params.ops?(t.get_non_major_departments(),t.form={title:"Edit Group "+t.group.name,type:"e",input:{id:t.group.id,name:t.group.name,description:t.group.description,department_id:t.group.department_id}}):"delete"===t.$route.params.ops&&(t.form={title:"Delete Group "+t.group.name,type:"d",input:{id:t.group.id}})}))):(this.group=this.form=null,this.get_groups())},loadRoles:function(){for(var t=0,e=Object.keys(window.roles);t<e.length;t++){var a=e[t];this.roles[a]=this.group.roles.includes(a)}},storeRoles:function(){var t=this;this.roles_error=this.roles_success=null,axios.post("/admin/groups/store-roles",{roles:this.roles,group:this.group.id}).then((function(e){t.role=e.data.role,t.roles_success=e.data.success}))},submitForm:function(t){switch(t.preventDefault(),this.form.type){case"c":this.postRequest("/admin/groups/store");break;case"d":this.form.input.id=this.group.id,this.postRequest("/admin/groups/destroy");break;case"e":this.form.input.id=this.group.id,this.postRequest("/admin/groups/edit")}},postRequest:function(t){var e=this;axios.post(t,this.form.input).then((function(t){e.groups=t.data.groups,null!=t.data.group?(e.group=t.data.group,e.$router.push({name:"ad.groups",params:{id:e.group.id}})):e.$router.push({name:"ad.groups"}),e.$root.post_success(t.data.success)}))},get_groups:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.filter.search&&(this.filter.search_q="&search="+this.filter.search),axios.get("/admin/groups?page="+e+this.filter.search_q).then((function(e){t.groups=e.data.groups}))},get_group:function(t){var e=this;axios.get("/admin/groups/"+t).then((function(t){e.group=t.data.group,e.loadRoles()}))}}},m=Object(r.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[t.groups?a("IndexGroups"):t._e(),t._v(" "),t.group&&!t.form?a("ViewGroups"):t._e(),t._v(" "),t.form?a("FormGroups"):t._e()],1)}),[],!1,null,"9ab2de64",null);e.default=m.exports}}]);